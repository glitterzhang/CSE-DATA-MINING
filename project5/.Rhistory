new.function(0.6,3)
new.function(0.4,4)
new.function(0.2,5)
new.function(0,6)
View(roc)
new.function<-function(a,b){
for(i in 1:nrow(income_knn1))
{
if (income_knn1[i,5]>=a)
income_knn1[i,6]=" <=50K"
else income_knn1[i,6]=" >50K"
}
## return(income_knn1[,6])
frequen<-as.matrix(table(income_knn1[,2],income_knn1[,6]))
roc[b,1]=frequen[1,1]/frequen[1,]
roc[b,2]=frequen[2,1]/frequen[2,]
return(roc[b,])
}
new.function(1,1)
new.function(0.8,2)
new.function(0.6,3)
new.function(0.4,4)
new.function(0.2,5)
new.function(0,6)
income_knn1<-income_knn
roc<-matrix(0,nrow=6,ncol = 2)
##
new.function<-function(a,b){
for(i in 1:nrow(income_knn1))
{
if (income_knn1[i,5]>=a)
income_knn1[i,6]=" <=50K"
else income_knn1[i,6]=" >50K"
}
## return(income_knn1[,6])
frequen<-as.matrix(table(income_knn1[,2],income_knn1[,6]))
roc[b,1]=frequen[1,1]/frequen[1,]
roc[b,2]=frequen[2,1]/frequen[2,]
return(roc[b,])
}
new.function(1,1)
new.function(0.8,2)
new.function(1,1)
new.function(0.8,2)
new.function(0.6,3)
new.function(0.4,4)
new.function(0.2,5)
new.function(0,6)
new.function(0.2,5)
income_knn1<-income_knn
roc<-matrix(0,nrow=6,ncol = 2)
##
new.function<-function(a,b){
for(i in 1:nrow(income_knn1))
{
if (income_knn1[i,5]>=a)
income_knn1[i,6]=" <=50K"
else income_knn1[i,6]=" >50K"
}
## return(income_knn1[,6])
frequen<-as.matrix(table(income_knn1[,2],income_knn1[,6]))
return(frequen)
roc[b,1]=frequen[1,1]/frequen[1,]
roc[b,2]=frequen[2,1]/frequen[2,]
return(roc[b,])
}
new.function(1,1)
new.function(0.8,2)
new.function(0.6,3)
new.function(0.4,4)
new.function(0.2,5)
new.function(0,6)
roc[b,1]=frequen[1,1]/frequen[1,]
roc[b,2]=frequen[2,1]/frequen[2,]
new.function(0.8,2)
roc[b,1]=frequen[1,1]/frequen[1,]
new.function<-function(a,b){
for(i in 1:nrow(income_knn1))
{
if (income_knn1[i,5]>=a)
income_knn1[i,6]=" <=50K"
else income_knn1[i,6]=" >50K"
}
## return(income_knn1[,6])
frequen<-as.matrix(table(income_knn1[,2],income_knn1[,6]))
roc[b,1]=frequen[1,1]/frequen[1,]
roc[b,2]=frequen[2,1]/frequen[2,]
return(roc[b,])
}
new.function(1,1)
new.function<-function(a,b){
for(i in 1:nrow(income_knn1))
{
if (income_knn1[i,5]>=a)
income_knn1[i,6]=" <=50K"
else income_knn1[i,6]=" >50K"
}
## return(income_knn1[,6])
frequen<-as.matrix(table(income_knn1[,2],income_knn1[,6]))
roc[b,1]=frequen[1,1]/frequen[1,]
roc[b,2]=frequen[2,1]/frequen[2,]
return(roc[b,1])
return(roc[b,2])
}
new.function(1,1)
new.function<-function(a,b){
for(i in 1:nrow(income_knn1))
{
if (income_knn1[i,5]>=a)
income_knn1[i,6]=" <=50K"
else income_knn1[i,6]=" >50K"
}
## return(income_knn1[,6])
frequen<-as.matrix(table(income_knn1[,2],income_knn1[,6]))
return(frequen[1,1]/frequen[1,])
}
new.function(1,1)
income_knn1<-income_knn
roc<-matrix(0,nrow=6,ncol = 2)
##
new.function<-function(a,b){
for(i in 1:nrow(income_knn1))
{
if (income_knn1[i,5]>=a)
income_knn1[i,6]=" <=50K"
else income_knn1[i,6]=" >50K"
}
## return(income_knn1[,6])
frequen<-as.matrix(table(income_knn1[,2],income_knn1[,6]))
return(frequen)
return(frequen[1,1]/frequen[1,])
}
new.function(0.8,2)
income_knn1<-income_knn
roc<-matrix(0,nrow=6,ncol = 2)
##
new.function<-function(a,b){
for(i in 1:nrow(income_knn1))
{
if (income_knn1[i,5]>=a)
income_knn1[i,6]=" <=50K"
else income_knn1[i,6]=" >50K"
}
## return(income_knn1[,6])
frequen<-as.matrix(table(income_knn1[,2],income_knn1[,6]))
return(frequen[1,1]/frequen[1,])
}
new.function(1,1)
new.function(0.8,2)
new.function(0.6,3)
new.function<-function(a,b){
for(i in 1:nrow(income_knn1))
{
if (income_knn1[i,5]>=a)
income_knn1[i,6]=" <=50K"
else income_knn1[i,6]=" >50K"
}
## return(income_knn1[,6])
frequen<-as.matrix(table(income_knn1[,2],income_knn1[,6]))
x<-frequen[1,1]/frequen[1,]
return(x)
}
new.function(0.8,2)
new.function<-function(a,b){
for(i in 1:nrow(income_knn1))
{
if (income_knn1[i,5]>=a)
income_knn1[i,6]=" <=50K"
else income_knn1[i,6]=" >50K"
}
## return(income_knn1[,6])
frequen<-as.matrix(table(income_knn1[,2],income_knn1[,6]))
## not work this part
roc[b,1]=frequen[1,1]/frequen[1,]
roc[b,2]=frequen[2,1]/frequen[2,]
return(roc[b,1])
return(roc[b,2])
}
new.function(0.8,2)
new.function<-function(a,b){
for(i in 1:nrow(income_knn1))
{
if (income_knn1[i,5]>=a)
income_knn1[i,6]=" <=50K"
else income_knn1[i,6]=" >50K"
}
## return(income_knn1[,6])
frequen<-as.matrix(table(income_knn1[,2],income_knn1[,6]))
## not work this part
return(frequen[1,1])
roc[b,1]=frequen[1,1]/frequen[1,]
roc[b,2]=frequen[2,1]/frequen[2,]
return(roc[b,1])
return(roc[b,2])
}
new.function(1,1)
new.function<-function(a,b){
for(i in 1:nrow(income_knn1))
{
if (income_knn1[i,5]>=a)
income_knn1[i,6]=" <=50K"
else income_knn1[i,6]=" >50K"
}
## return(income_knn1[,6])
frequen<-as.matrix(table(income_knn1[,2],income_knn1[,6]))
## not work this part
return(frequen[1,1]/frequen[1,])
roc[b,1]=frequen[1,1]/frequen[1,]
roc[b,2]=frequen[2,1]/frequen[2,]
return(roc[b,1])
return(roc[b,2])
}
new.function(1,1)
income_knn1<-income_knn
roc<-matrix(0,nrow=6,ncol = 2)
##
new.function<-function(a,b){
for(i in 1:nrow(income_knn1))
{
if (income_knn1[i,5]>=a)
income_knn1[i,6]=" <=50K"
else income_knn1[i,6]=" >50K"
}
## return(income_knn1[,6])
frequen<-as.matrix(table(income_knn1[,2],income_knn1[,6]))
## not work this part
return((frequen[1,1]/frequen[1,])
roc[b,1]=frequen[1,1]/frequen[1,]
roc[b,2]=frequen[2,1]/frequen[2,]
return(roc[b,1])
return(roc[b,2])
}
new.function(1,1)
income_knn1<-income_knn
roc<-matrix(0,nrow=6,ncol = 2)
##
new.function<-function(a,b){
for(i in 1:nrow(income_knn1))
{
if (income_knn1[i,5]>=a)
income_knn1[i,6]=" <=50K"
else income_knn1[i,6]=" >50K"
}
## return(income_knn1[,6])
frequen<-as.matrix(table(income_knn1[,2],income_knn1[,6]))
## not work this part
roc[b,1]=frequen[1,1]/(frequen[1,1]+frequen[1,2])
roc[b,2]=frequen[2,1]/frequen[2,]
return(roc[b,1])
return(roc[b,2])
}
new.function(1,1)
new.function(0.8,2)
frequen<-as.matrix(table(income_knn1[,2],income_knn1[,6]))
frequen
roc[1,6]=frequen[1,1]/frequen[1,]
roc[2,6]=frequen[2,1]/frequen[2,]
for(i in 1:nrow(income_knn1))
{
if (income_knn1[i,5]>=0.2)
income_knn1[i,7]=" <=50K"
else income_knn1[i,7]=" >50K"
}
frequen<-as.matrix(table(income_knn1[,2],income_knn1[,7]))
frequen
roc[1,5]=frequen[1,1]/sum(frequen[1,])
roc[2,5]=frequen[2,1]/sum(frequen[2,])
for(i in 1:nrow(income_knn1))
{
if (income_knn1[i,5]>=0.2)
income_knn1[i,7]=" <=50K"
else income_knn1[i,7]=" >50K"
}
frequen<-as.matrix(table(income_knn1[,2],income_knn1[,7]))
frequen
roc[1,5]=frequen[1,1]/sum(frequen[1,])
roc[2,5]=frequen[2,1]/sum(frequen[2,])
income_knn1<-income_knn
roc<-matrix(0,nrow=6,ncol = 2)
##
for(i in 1:nrow(income_knn1))
{
if (income_knn1[i,5]>=0.2)
income_knn1[i,7]=" <=50K"
else income_knn1[i,7]=" >50K"
}
frequen<-as.matrix(table(income_knn1[,2],income_knn1[,7]))
frequen
roc[1,5]=frequen[1,1]/sum(frequen[1,])
roc[2,5]=frequen[2,1]/sum(frequen[2,])
for(i in 1:nrow(income_knn1))
{
if (income_knn1[i,5]>=0.2)
income_knn1[i,7]=" <=50K"
else income_knn1[i,7]=" >50K"
}
View(income_knn1)
View(income_knn1)
new.function<-function(a){
for(i in 1:nrow(income_knn1))
{
if (income_knn1[i,5]>=a)
income_knn1[i,6]=" <=50K"
else income_knn1[i,6]=" >50K"
}
## return(income_knn1[,6])
frequen<-as.matrix(table(income_knn1[,2],income_knn1[,6]))
return(frequen)
}
new.function(1)
roc[1,1]=frequen[1,1]/frequen[1,]
roc[1,2]=frequen[2,1]/frequen[2,]
new.function<-function(a){
for(i in 1:nrow(income_knn1))
{
if (income_knn1[i,5]>=a)
income_knn1[i,6]=" <=50K"
else income_knn1[i,6]=" >50K"
}
## return(income_knn1[,6])
frequen<-as.matrix(table(income_knn1[,2],income_knn1[,6]))
return(frequen)
}
new.function(1)
roc[1,1]=frequen[1,1]/frequen[1,]
roc[1,2]=frequen[2,1]/frequen[2,]
new.function<-function(a){
for(i in 1:nrow(income_knn1))
{
if (income_knn1[i,5]>=a)
income_knn1[i,6]=" <=50K"
else income_knn1[i,6]=" >50K"
}
## return(income_knn1[,6])
frequen<-as.matrix(table(income_knn1[,2],income_knn1[,6]))
return(frequen)
}
new.function(1)
roc[1,1]=frequen[1,1]/frequen[1,]
new.function<-function(a){
for(i in 1:nrow(income_knn1))
{
if (income_knn1[i,5]>=a)
income_knn1[i,6]=" <=50K"
else income_knn1[i,6]=" >50K"
}
## return(income_knn1[,6])
frequen<-as.matrix(table(income_knn1[,2],income_knn1[,6]))
return(frequen)
}
frequen<-new.function(1)
roc[1,1]=frequen[1,1]/frequen[1,]
new.function<-function(a){
for(i in 1:nrow(income_knn1))
{
if (income_knn1[i,5]>=a)
income_knn1[i,6]=" <=50K"
else income_knn1[i,6]=" >50K"
}
## return(income_knn1[,6])
frequen<-as.matrix(table(income_knn1[,2],income_knn1[,6]))
return(frequen)
}
frequen<-new.function(1)
roc[1,1]=frequen[1,1]/frequen[1,]
roc<-matrix(0,nrow=6,ncol = 2)
View(roc)
frequen[1,1]/frequen[1,]
new.function<-function(a,b){
for(i in 1:nrow(income_knn1))
{
if (income_knn1[i,5]>=a)
income_knn1[i,6]=" <=50K"
else income_knn1[i,6]=" >50K"
}
## return(income_knn1[,6])
frequen<-as.matrix(table(income_knn1[,2],income_knn1[,6]))
roc[b,1]=frequen[1,1]/sum(frequen[1,])
roc[b,2]=frequen[2,1]/sum(frequen[2,])
}
new.function(1,1)
new.function<-function(a,b){
for(i in 1:nrow(income_knn1))
{
if (income_knn1[i,5]>=a)
income_knn1[i,6]=" <=50K"
else income_knn1[i,6]=" >50K"
}
## return(income_knn1[,6])
frequen<-as.matrix(table(income_knn1[,2],income_knn1[,6]))
roc[b,1]=frequen[1,1]/sum(frequen[1,])
roc[b,2]=frequen[2,1]/sum(frequen[2,])
return(roc[b,1])
return(roc[b,2])
}
new.function(1,1)
new.function<-function(a,b){
for(i in 1:nrow(income_knn1))
{
if (income_knn1[i,5]>=a)
income_knn1[i,6]=" <=50K"
else income_knn1[i,6]=" >50K"
}
## return(income_knn1[,6])
frequen<-as.matrix(table(income_knn1[,2],income_knn1[,6]))
roc[b,1]=frequen[1,1]/sum(frequen[1,])
roc[b,2]=frequen[2,1]/sum(frequen[2,])
return(roc[b,1],roc[b,2])
}
new.function(1,1)
new.function<-function(a,b){
for(i in 1:nrow(income_knn1))
{
if (income_knn1[i,5]>=a)
income_knn1[i,6]=" <=50K"
else income_knn1[i,6]=" >50K"
}
## return(income_knn1[,6])
frequen<-as.matrix(table(income_knn1[,2],income_knn1[,6]))
roc[b,1]=frequen[1,1]/sum(frequen[1,])
roc[b,2]=frequen[2,1]/sum(frequen[2,])
return(roc[b,])
}
new.function(1,1)
View(roc)
income_knn1<-income_knn
roc<-matrix(0,nrow=6,ncol = 2)
##
new.function<-function(a,b){
for(i in 1:nrow(income_knn1))
{
if (income_knn1[i,5]>=a)
income_knn1[i,6]=" <=50K"
else income_knn1[i,6]=" >50K"
}
## return(income_knn1[,6])
frequen<-as.matrix(table(income_knn1[,2],income_knn1[,6]))
roc[b,1]=frequen[1,1]/sum(frequen[1,])
roc[b,2]=frequen[2,1]/sum(frequen[2,])
return(roc[b,])
}
new.function(1,1)
income_knn1<-income_knn
roc<-matrix(0,nrow=6,ncol = 2)
##
new.function<-function(a,b){
for(i in 1:nrow(income_knn1))
{
if (income_knn1[i,5]>=a)
income_knn1[i,6]=" <=50K"
else income_knn1[i,6]=" >50K"
}
## return(income_knn1[,6])
frequen<-as.matrix(table(income_knn1[,2],income_knn1[,6]))
roc[b,1]=frequen[1,1]/sum(frequen[1,])
roc[b,2]=frequen[2,1]/sum(frequen[2,])
return(roc[b,])
}
roc[1,]<-new.function(1,1)
roc[2,]<-new.function(0.8,2)
roc[3,]<-new.function(0.6,3)
roc[4,]<-new.function(0.4,4)
roc[5,]<-new.function(0.2,5)
roc[6,]<-new.function(0,6)
View(roc)
roc[6,]<-new.function(0,6)
print(roc[])
income_train<-read.csv('/Users/zhangyifei/Desktop/CSE-DATA-MINING/lab2/income_NEW.csv')
income_test<-read.csv('/Users/zhangyifei/Desktop/CSE-DATA-MINING/lab2/income_TEST_FINAL.csv')
##delete the object that contains missing data
income_train<-income_train[income_train[,2]!=" ?",]
income_train<-income_train[income_train[,7]!=" ?",]
income_train<-income_train[income_train[,14]!=" ?",]
income_test<-income_test[income_test[,2]!=" ?",]
income_test<-income_test[income_test[,7]!=" ?",]
income_test<-income_test[income_test[,14]!=" ?",]
#min-max normalization
income_train1<-income_train
income_test1<-income_test
min_max <- function(x) {
return ((x - min(x)) / (max(x) - min(x)))
}
income_train1[,1]<-min_max(income_train1[,1])
income_train1[,3]<-min_max(income_train1[,3])
income_train1[,5]<-min_max(income_train1[,5])
income_train1[,11]<-min_max(income_train1[,11])
income_train1[,12]<-min_max(income_train1[,12])
income_train1[,13]<-min_max(income_train1[,13])
income_test1[,1]<-min_max(income_test1[,1])
income_test1[,3]<-min_max(income_test1[,3])
income_test1[,5]<-min_max(income_test1[,5])
income_test1[,11]<-min_max(income_test1[,11])
income_test1[,12]<-min_max(income_test1[,12])
income_test1[,13]<-min_max(income_test1[,13])
## education and education_cat display duplicate information. So,we can remove education column
income_train1<-income_train1[,-4]
income_test1<-income_test1[,-4]
#Distance_euclidean distance for numeric
income_euclidean<-matrix(0,nrow=nrow(income_test1),ncol=nrow(income_train1))
for(j in 1:nrow(income_test1))
{
for(i in 1:nrow(income_train1))
{
income_euclidean[j,i]<-sqrt((income_test1[j,1]-income_train1[i,1])^2+(as.character(income_train1[i,2])!=as.character(income_test1[j,2]))^2+
(income_test1[j,3]-income_train1[i,3])^2+(income_test1[j,4]-income_train1[i,4])^2+
(as.character(income_train1[i,5])!=as.character(income_test1[j,5]))^2+(as.character(income_train1[i,6])!=as.character(income_test1[j,6]))^2+
(as.character(income_train1[i,7])!=as.character(income_test1[j,7]))^2+ (as.character(income_train1[i,8])!=as.character(income_test1[j,8]))^2+
(as.character(income_train1[i,9])!=as.character(income_test1[j,9]))^2+ (income_test1[j,10]-income_train1[i,10])^2+
(income_test1[j,11]-income_train1[i,11])^2+(income_test1[j,12]-income_train1[i,12])^2+
(as.character(income_train1[i,13])!=as.character(income_test1[j,13]))^2)
}
}
